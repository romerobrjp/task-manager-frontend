<div *ngIf="task">
  <h1 class="page-header text-center">Detalhes da tarefa <strong> {{ task?.title }} </strong> </h1>

  <form #taskForm="ngForm" *ngIf="task">
    <div class="row">
      <div
        class="form-group col-md-6 has-feedback" 
        [class.has-error]="showFieldError(title)"
        [class.has-success]="showFieldSuccess(title)"
      >
        <label for="title" class="control-label">Título</label>
        <input
          id="title"
          class="form-control"
          minlength="2"
          maxlength="255"
          name="title"
          placeholder="Título da tarefa aqui..."
          required
          type="text"
          [(ngModel)]="task.title"
          #title="ngModel"
        />

        <span
          class="glyphicon form-control-feedback" 
          [class.glyphicon-ok]="title.valid" 
          [class.glyphicon-remove]="title.invalid && title.touched"
          style="margin-right: 20px"
        ></span>

        <div class="text-danger" *ngIf="showFieldError(title)">
          <div *ngIf="title.errors.required">O título é obrigatório</div>
          <div *ngIf="title.errors.minlength">O título deve ter no mínimo 2 caracteres</div>
          <div *ngIf="title.errors.maxlength">O título deve ter no máximo 255 caracteres</div>
        </div>
      </div>

      <div class="form-group col-md-3">
        <label for="deadline" class="control-label">Prazo de entrega</label>
        <input
          id="deadline"
          class="form-control"
          name="deadline"
          placeholder="Informe o prazo"
          required
          type="text"
          [(ngModel)]="task.deadline"
        />
      </div>

      <div
        class="form-group col-md-3 has-feedback"
        [class.has-error]="done.invalid"
        [class.has-success]="showFieldSuccess(done)"
      >
        <label for="done" class="control-label">Situação</label>
        <select 
          id="done"
          class="form-control"
          name="done"
          required
          #done="ngModel"
          [(ngModel)]="task.done"
        >
          <option *ngFor="let option of doneOptions" [value]="option.value">{{ option.text }}</option>
        </select>

        <span
          class="glyphicon form-control-feedback" 
          [class.glyphicon-ok]="showFieldSuccess(done)" 
          [class.glyphicon-remove]="done.invalid"
          style="margin-right: 30px"
        ></span>
      </div>
    </div>

    <div class="row">
      <div
        class="form-group col-md-12"
      >
        <label for="description" class="control-label">Descrição</label>
        <textarea 
          id="description"
          class="form-control"
          name="description"
          placeholder="Informe a descrição da task aqui"
          rows="5"
          [(ngModel)]="task.description"
        ></textarea>
      </div>
    </div>
    
    <div class="form-group text-center">
      <div>
        <button class="btn btn-default" (click)="goBack()">Voltar</button>
        <button type="submit" class="btn btn-success" (click)='update()' [disabled]="taskForm.invalid">Atualizar</button>
      </div>
    </div>

    <hr />

    <pre>title.errors: {{ title.errors | json }}</pre>
    <pre>done.errors: {{ done.errors | json }}</pre>
  </form>

  <hr />

  <pre>{{ task | json }}</pre>
</div>